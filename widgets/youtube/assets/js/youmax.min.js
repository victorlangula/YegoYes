var youmax_global_options={};!function(a){var c=function(a){var b,c;a=a.replace("PT","").replace("S","").replace("M",":").replace("H",":");var d=a.split(":");c=d[0];for(var e=1;e<d.length;e++)b=d[e],""==b?c+=":00":(b=parseInt(b,10),c+=10>b?":0"+b:":"+b);return 1==d.length&&(c="0:"+c),c},d=function(a){if(null==a||""==a||"undefined"==a)return"?";var b=a.toString().split("T")[0].split("-"),c=new Date,d=c.getFullYear(),e=parseInt(b[0],10),f=c.getMonth(),g=parseInt(b[1],10),h=f+12*d-(g+12*e);if(1>=h)return"1 month";if(12>h)return h+" months";var i=Math.floor(h/12);return 1>=i?"1 year":12>i?i+" years":void 0},e=function(a){if(null==a||""==a||"undefined"==a)return"?";a=a.toString();for(var b="",c=0,d=a.length;d>=0;d--)b+=a.charAt(d),3==c&&d>0?(c=1,b+=","):c++;return b.split("").reverse().join("")},f=function(){youmaxWidgetWidth=a("#youmax").width(),a("#youmax").append('<div id="youmax-header"><div id="youmax-stat-holder"></div></div>'),a("#youmax").append('<div id="youmax-tabs"><span id="featured_" class="youmax-tab">Featured</span><span id="uploads_" class="youmax-tab">Uploads</span><span id="playlists_" class="youmax-tab">Playlists</span></div>'),a("#youmax").append('<div id="youmax-encloser"><iframe id="youmax-video" width="'+(youmaxWidgetWidth-2)+'" height="'+youmaxWidgetWidth/youmax_global_options.youtubeVideoAspectRatio+'" src="" frameborder="0" allowfullscreen></iframe><div id="youmax-video-list-div"></div><div id="youmax-load-more-div">LOAD MORE</div></div>'),a("#youmax-video").hide(),a("#youmax").append('<div id="youmax-lightbox"><div style="width:100%; position:absolute; top:20%;"><iframe id="youmax-video-lightbox" width="640" height="360" src="" frameborder="0" allowfullscreen></iframe></div></div>'),a("#youmax-lightbox").hide()},g=function(b){a.ajax({url:b,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(a){youmaxChannelId=a.items[0].id,h(youmaxChannelId)},error:function(a){alert(a)},beforeSend:i})},h=function(b){var c="https://www.googleapis.com/youtube/v3/channels?part=brandingSettings%2Csnippet%2Cstatistics%2CcontentDetails&id="+b+"&key="+youmax_global_options.apiKey;a.ajax({url:c,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(a){l(a)},error:function(a){alert(a)},beforeSend:i})},i=function(a){a&&a.overrideMimeType&&a.overrideMimeType("application/j-son;charset=UTF-8")},j=function(){youmax_global_options.youmaxItemCount=0,a("#youmax-video-list-div").empty(),a("#youmax-video").hide(),a("#youmax-video").attr("src",""),a("#youmax-video-list-div").append('<div style="text-align:center; height:200px; font:14px Calibri;"><br><br><br><br><br><br>loading...</div>')},k=function(){youTubePlaylistURL=youmax_global_options.youTubePlaylistURL,console.log("inside init featured - "+youTubePlaylistURL),null!=youTubePlaylistURL&&-1!=youTubePlaylistURL.indexOf("youtube.com/playlist?list=")&&(youmaxFeaturedPlaylistId=youTubePlaylistURL.substring(youTubePlaylistURL.indexOf("?list=")+6),youmax_global_options.youmaxFeaturedPlaylistId=youmaxFeaturedPlaylistId)},l=function(b){console.log("showInfo"),console.log(b);var c=b.items[0],d=c.id,e=c.snippet.title,f=c.snippet.thumbnails.default.url;c.statistics.subscriberCount,c.statistics.viewCount;var j=c.contentDetails.relatedPlaylists.uploads;a("#youmax-header").append('<img id="youmax-header-logo" src="'+f+'"/>'+e),a("#youmax-header").append('&nbsp;&nbsp;&nbsp;&nbsp;<div class="youmax-subscribe"><div class="g-ytsubscribe" data-channelid="'+d+'" data-layout="default" data-count="default"></div></div>'),m(),a("#youmax-tabs").find("span[id^=uploads_]").attr("id","uploads_"+j),youmaxDefaultTab=youmax_global_options.youmaxDefaultTab,"undefined"==typeof youmaxDefaultTab||null==youmaxDefaultTab||""==youmaxDefaultTab||"undefined"==youmaxDefaultTab?a("#youmax-tabs span[id^=featured_]").click():"UPLOADS"==youmaxDefaultTab.toUpperCase()||"UPLOAD"==youmaxDefaultTab.toUpperCase()?a("#youmax-tabs span[id^=uploads_]").click():"PLAYLISTS"==youmaxDefaultTab.toUpperCase()||"PLAYLIST"==youmaxDefaultTab.toUpperCase()?a("#youmax-tabs span[id^=playlists_]").click():("FEATURED"==youmaxDefaultTab.toUpperCase()||"FEATURED"==youmaxDefaultTab.toUpperCase())&&a("#youmax-tabs span[id^=featured_]").click()},m=function(){a.ajaxSetup({cache:!0}),a.getScript("https://apis.google.com/js/platform.js").done(function(){}).fail(function(){})},n=function(b,c){console.log(b),c||a("#youmax-video-list-div").empty();var e=b.nextPageToken,f=a("#youmax-load-more-div");null!=e&&"undefined"!=e&&""!=e?f.data("nextpagetoken",e):f.data("nextpagetoken",""),youmaxColumns=youmax_global_options.youmaxColumns;for(var g=b.items,h=[],i=0,k=0;k<g.length;k++)playListId=g[k].id,playlistSize=g[k].contentDetails.itemCount,0>=playlistSize?i++:(h.push(playListId),playlistTitle=g[k].snippet.title,playlistUploaded=g[k].snippet.publishedAt,playlistThumbnail=g[k].snippet.thumbnails.medium.url,0!=(k+youmax_global_options.youmaxItemCount-i)%youmaxColumns?a("#youmax-video-list-div").append('<div class="youmax-video-tnail-box" style="width:'+(100/youmaxColumns-4)+'%;" id="'+playListId+'"><div class="youmax-video-tnail" style="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src=\''+playlistThumbnail+"', sizingMethod='scale'); background-image:url('"+playlistThumbnail+'\')"><div class="youmax-playlist-sidebar" id="youmax-playlist-sidebar-'+playListId+'"><span class="youmax-playlist-video-count"><b>'+playlistSize+'</b><br/>VIDEOS</span></div></div><span class="youmax-video-list-title">'+playlistTitle+'</span><br/><span class="youmax-video-list-views">'+d(playlistUploaded)+" ago</span></div>"):a("#youmax-video-list-div").append('<div class="youmax-video-tnail-box" style="width:'+(100/youmaxColumns-4)+'%; clear:both;" id="'+playListId+'"><div class="youmax-video-tnail" style="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src=\''+playlistThumbnail+"', sizingMethod='scale'); background-image:url('"+playlistThumbnail+'\')"><div class="youmax-playlist-sidebar" id="youmax-playlist-sidebar-'+playListId+'"><span class="youmax-playlist-video-count"><b>'+playlistSize+'</b><br/>VIDEOS</span></div></div><span class="youmax-video-list-title">'+playlistTitle+'</span><br/><span class="youmax-video-list-views">'+d(playlistUploaded)+" ago</span></div>"));youmax_global_options.youmaxItemCount+=g.length-i,a(".youmax-video-tnail-box").click(function(){j(),playlistTitle=a(this).find(".youmax-video-list-title").text(),r("play_"+this.id,playlistTitle)}),v()},o=function(b,c,e){console.log(b),e||(a("#youmax-video-list-div").empty(),c&&(a(".youmax-tab-hover").removeClass("youmax-tab-hover"),a("#youmax-video-list-div").append('<span class="youmax-showing-title youmax-tab-hover" id="uploads_'+b.items[0].snippet.playlistId+'" style="max-width:100%;"><span class="youmax-showing">&nbsp;&nbsp;Showing playlist: </span>'+c+"</span><br/>")));var f=b.nextPageToken,g=a("#youmax-load-more-div");youmaxColumns=youmax_global_options.youmaxColumns,null!=f&&"undefined"!=f&&""!=f?g.data("nextpagetoken",f):g.data("nextpagetoken","");for(var h=b.items,i=[],j=0;j<h.length;j++)videoId=h[j].snippet.resourceId.videoId,videoTitle=h[j].snippet.title,videoUploaded=h[j].snippet.publishedAt,videoThumbnail=h[j].snippet.thumbnails.medium.url,i.push(videoId),0!=(j+youmax_global_options.youmaxItemCount)%youmaxColumns?a("#youmax-video-list-div").append('<div class="youmax-video-tnail-box" style="width:'+(100/youmaxColumns-4)+'%;" id="'+videoId+'"><div class="youmax-video-tnail" style="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src=\''+videoThumbnail+"', sizingMethod='scale'); background-image:url('"+videoThumbnail+'\')"><div class="youmax-duration"></div></div><span class="youmax-video-list-title">'+videoTitle+'</span><br/><span class="youmax-video-list-views">'+d(videoUploaded)+" ago</span></div>"):a("#youmax-video-list-div").append('<div class="youmax-video-tnail-box" style="width:'+(100/youmaxColumns-4)+'%; clear:both;" id="'+videoId+'"><div class="youmax-video-tnail" style="filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src=\''+videoThumbnail+"', sizingMethod='scale'); background-image:url('"+videoThumbnail+'\')"><div class="youmax-duration"></div></div><span class="youmax-video-list-title">'+videoTitle+'</span><br/><span class="youmax-video-list-views">'+d(videoUploaded)+" ago</span></div>");youmax_global_options.youmaxItemCount+=h.length,a(".youmax-video-tnail-box").click(function(){youmax_global_options.showVideoInLightbox?u(this.id):(a("#youmax-video").attr("src","http://www.youtube.com/embed/"+this.id),a("#youmax-video").show(),a("html,body").animate({scrollTop:a("#youmax-header").offset().top},"slow"))}),p(i),v()},p=function(b){apiVideoStatURL="https://www.googleapis.com/youtube/v3/videos?part=statistics%2CcontentDetails&id="+b+"&key="+youmax_global_options.apiKey,a.ajax({url:apiVideoStatURL,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(a){q(a)},error:function(a){alert(a)},beforeSend:i})},q=function(b){for(var f,d=b.items,g=0;g<d.length;g++)videoId=d[g].id,videoViewCount=d[g].statistics.viewCount,videoViewCount=e(videoViewCount),videoDuration=d[g].contentDetails.duration,videoDuration=c(videoDuration),videoDefinition=d[g].contentDetails.definition.toUpperCase(),f=a("#youmax-video-list-div #"+videoId),f.find(".youmax-video-list-views").prepend(videoViewCount+" views | "),f.find(".youmax-duration").append(videoDuration)},r=function(b,c,d){var e="",f=!1;null!=d&&(e="&pageToken="+d,f=!0);var g=b.substring(b.indexOf("_")+1),h="https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId="+g+"&maxResults="+youmax_global_options.maxResults+e+"&key="+youmax_global_options.apiKey;console.log("apiUploadURL-"+h),a.ajax({url:h,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(a){o(a,c,f)},error:function(a){alert(a)},beforeSend:i})},t=function(b){var c="",d=!1;null!=b&&(c="&pageToken="+b,d=!0);var e="https://www.googleapis.com/youtube/v3/playlists?part=contentDetails,snippet&channelId="+youmaxChannelId+"&maxResults="+youmax_global_options.maxResults+c+"&key="+youmax_global_options.apiKey;a.ajax({url:e,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(a){n(a,d)},error:function(a){alert(a)},beforeSend:i})},u=function(b){a("#youmax-lightbox").show(),a("#youmax-video-lightbox").attr("src","http://www.youtube.com/embed/"+b),a("#youmax-lightbox").click(function(){a("#youmax-video-lightbox").attr("src",""),a("#youmax-lightbox").hide()})},v=function(){var b=a("#youmax-load-more-div");b.removeClass("youmax-load-more-div-click"),b.text("LOAD MORE")},w=function(){a("#youmax").empty(),f(),j(),a(".youmax-tab").click(function(){a(".youmax-tab-hover").removeClass("youmax-tab-hover"),a(this).addClass("youmax-tab-hover"),youmaxTabId=this.id,j(),-1!=youmaxTabId.indexOf("featured_")?r("featured_"+youmax_global_options.youmaxFeaturedPlaylistId,null,null):-1!=youmaxTabId.indexOf("uploads_")?r(youmaxTabId):-1!=youmaxTabId.indexOf("playlists_")&&t()}),a("#youmax-load-more-div").click(function(){var b=a("#youmax-load-more-div");b.html("LOADING.."),b.addClass("youmax-load-more-div-click");var c=a(".youmax-tab-hover").attr("id"),d=b.data("nextpagetoken");console.log("load more clicked : nextPageToken-"+d),null!=d&&"undefined"!=d&&""!=d?-1!=c.indexOf("featured_")?r("featured_"+youmax_global_options.youmaxFeaturedPlaylistId,null,d):-1!=c.indexOf("uploads_")?r(c,null,d):"playlists_"==c&&t(d):b.html("ALL DONE")}),youTubeChannelURL=youmax_global_options.youTubeChannelURL,null!=youTubeChannelURL&&(s=youTubeChannelURL.indexOf("/user/"),-1!=s?(userId=youTubeChannelURL.substring(s+6),apiUrl="https://www.googleapis.com/youtube/v3/channels?part=id&forUsername="+userId+"&key="+youmax_global_options.apiKey,g(apiUrl)):(s=youTubeChannelURL.indexOf("/channel/"),-1!=s?(youmaxChannelId=youTubeChannelURL.substring(s+9),youmax_global_options.youmaxChannelId=youmaxChannelId,h(youmaxChannelId)):alert("Could Not Find Channel..")))};a.fn.youmax=function(a){youmax_global_options.apiKey=a.apiKey,youmax_global_options.youTubeChannelURL=a.youTubeChannelURL||"",youmax_global_options.youTubePlaylistURL=a.youTubePlaylistURL||"",youmax_global_options.youmaxDefaultTab=a.youmaxDefaultTab||"FEATURED",youmax_global_options.youmaxColumns=a.youmaxColumns||3,youmax_global_options.showVideoInLightbox=a.showVideoInLightbox||!1,youmax_global_options.youmaxChannelId="",youmax_global_options.maxResults=a.maxResults||15,youmax_global_options.youmaxItemCount=0,youmax_global_options.youtubeVideoAspectRatio=640/360,youmax_global_options.youtubeMqdefaultAspectRatio=300/180,k(),w()}}(jQuery);
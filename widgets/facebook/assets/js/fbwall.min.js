!function(e){function t(e){return e.replace(/\b((http|https):\/\/\S+)/g,'<a href="$1" target="_blank">$1</a>')}function s(e){var t=new Date(e),s=new Date-t;if(1e4>=s)return"Just now";var n=null,a={millisecond:1,second:1e3,minute:60,hour:60,day:24,month:30,year:12};for(var i in a){if(s<a[i])break;n=i,s/=a[i]}return s=Math.floor(s),1!==s&&(n+="s"),[s,n,"ago"].join(" ")}e.fn.facebookWall=function(n){if(n=n||{},!n.id)throw new Error("You need to provide an user/page id!");if(!n.access_token)throw new Error("You need to provide an access token!");n=e.extend({limit:15},n);var a="https://graph.facebook.com/"+n.id+"/?fields=name,picture&access_token="+n.access_token+"&callback=?",i="https://graph.facebook.com/"+n.id+"/posts/?access_token="+n.access_token+"&callback=?&date_format=U&limit="+n.limit,o=this;return e.when(e.getJSON(a),e.getJSON(i)).done(function(n,a){var i={user:n[0],posts:[]};e.each(a[0].data,function(){if("link"!=this.type&&"status"!=this.type||!this.message)return!0;this.from.picture=i.user.picture.data.url,this.created_time=s(1e3*this.created_time),this.message=t(this.message);var e=0;"undefined"!=typeof this.comments&&(e=this.comments.data.length),this.comment_count=e;var n=0;"undefined"!=typeof this.likes&&(n=this.likes.data.length),this.likes_count=n,i.posts.push(this)}),e("#headingTpl").tmpl(i.user).appendTo(o),e("#feedTpl").tmpl(i.posts).appendTo(o)}),this}}(jQuery);